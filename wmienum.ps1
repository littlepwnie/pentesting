# General information

"System information..."
Get-WmiObject -Class Win32_ComputerSystem

"Network adapters..."
Get-WmiObject -Class Win32_NetworkAdapterConfiguration

"Collectin User account information..."
Get-WmiObject -Class Win32_UserAccount

"Collectin Goup information..."
Get-WmiObject -Class Win32_Group

"Looking for shadow copies..."
Get-WmiObject -Class Win32_shadowcopy

# Active directory enumeration

"Computer name..."
Get-WmiObject -Namespace root/directory/ldap -Class ds_domain | select PSComputerName

"Domain..."
(Get-WmiObject -Class win32_computersystem).Domain

"Password policy..."
Get-WmiObject -Namespace root/directory/ldap -Class ds_domain | select DS_lockoutDuration, DS_lockOutObservationWindow, DS_lockoutThreshold, DS_maxPwdAge, DS_minPwdAge, DS_minPwdLenght, DS_pwdHistoryLength, DS_pwdProperties

"Collectin Goup information..."
Get-WmiObject -Class Win32_GroupInDomain

"Group membership of the domain admins group for current and all trusted domains..."
Get-WmiObject -Class Win32_GroupUser | Where-Object {$_.GroupComponent -match ""Domain Admins} | Foreach-Object {[wmi]$.PartComponent}

"Getting all domain computers' names..."
Get-WmiObject -Namespace root/directory/ldap -Class ds_computer | select -ExpandProperty ds_cn

Read-Host -Prompt "Press Enter to exit"
